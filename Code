```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, highlight=FALSE, warning=FALSE)
```

```{r, echo=FALSE, comment=NA}
library(ggplot2)
library(tidyverse)
library(car)
library(ggpubr)
library(knitr)
library(kableExtra)
climate<-read.csv("/Users/rahulmreddy/Downloads/Rfiles/climatechange.csv")

gpr<-NULL
rank_group<-function(x){
  if(x<26){gpr<-c(gpr,"Top25")}
  else{gpr<-c(gpr,"Bottom25")}
}

pt2<-sapply(climate$gpr,rank_group)
combined_data<-cbind(climate,pt2)


a<-ggplot(combined_data, aes(x=pt2,y=co2EPC,color=pt2))+geom_boxplot()+geom_jitter()+labs(title="CO2 Emmission Rate/PerCapita vs State Ranking",x="Climate Change State Ranking",y="Annual CO2 Emission Rate/Per Capita")+labs(color="State")+theme(plot.title=element_text(size=9),text=element_text(size=9))

b<-ggplot(climate, aes(x=gpr,y=co2EPC))+geom_point()+geom_smooth(method=lm,color="red",alpha=0.2)+stat_cor(x.label=0,y.label=100)+labs(title="Correlation: CO2 Emmision Rate vs. State Ranking ",x="Climate Change State Ranking",y="Annual CO2 Emission Rate/PerCapita")+theme(plot.title=element_text(size=9),text=element_text(size=9))

climateless<-read.csv("/Users/rahulmreddy/Downloads/Rfiles/climateless.csv")
c<-ggplot(climateless,aes(x=co2EPC))+geom_histogram()+labs(title="CO2 emission rates in Bottom 25 Ranked States",x="CO2 Emission Rates Per Capita")+theme(plot.title=element_text(size=9),text=element_text(size=9))
d<-ggplot(climateless,aes(sample=co2EPC))+stat_qq()+stat_qq_line()+labs(title="Corresponding qqplot for Bottom 25 States")+theme(plot.title=element_text(size=9),text=element_text(size=9))


climatemore<-read.csv("/Users/rahulmreddy/Downloads/Rfiles/climatemore.csv")
e<-ggplot(climatemore,aes(x=co2EPC))+geom_histogram()+labs(title="CO2 emission rates in Top 25 Ranked states",x="CO2 Emission Rates Per Capita")+theme(plot.title=element_text(size=9),text=element_text(size=9))
f<-ggplot(climatemore,aes(sample=co2EPC))+stat_qq()+stat_qq_line()+labs(title="Corresponding qqplot for Top 25 States")+theme(plot.title=element_text(size=9),text=element_text(size=9))



```




```
